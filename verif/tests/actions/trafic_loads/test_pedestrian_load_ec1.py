# -*- coding: utf-8 -*-
''' Test values of pedestrian loads computed according to EC1.'''

from __future__ import division
from __future__ import print_function


__author__= "Luis C. PÃ©rez Tato (LCPT) and Ana Ortega (AOO)"
__copyright__= "Copyright 2015, LCPT and AOO"
__license__= "GPL"
__version__= "3.0"
__email__= "l.pereztato@gmail.com"

import math
from actions.pedestrian_trafic import EC1_pedestrian_load_models as plm

fs= 2.25 # Hz
walking= True
pedestrianLoad= plm.PedestrianLoad(fs, walking)

ti= list()
vLoad= list()
hLoad= list()
for i in range(0,100):
    t= float(i)/100
    F= pedestrianLoad.getLoad(t)
    ti.append(t)
    vLoad.append(F[0]) # Vertical load.
    hLoad.append(F[1]) # Horizontal load.

vLoadRef= [481.25000000000006, 541.3779565088339, 604.6708486168018, 669.8658132123473, 735.6620357315466, 800.7467049007813, 863.8212068459776, 923.6270359256097, 978.9709052967908, 1028.7485561912467, 1071.9667908421998, 1107.7632894461221, 1135.4238157577706, 1154.3964680206948, 1164.3026908888958, 1164.9448286222344, 1156.3100688490692, 1138.5706982074653, 1112.0806647642491, 1077.36851580088, 1035.1268518762622, 986.198507586264, 931.559734750884, 872.3007235696281, 809.6038504003417, 744.7200861767008, 678.9440361797724, 613.5881091872009, 549.9563313948452, 489.3183275934265, 432.8839887455596, 381.7793314130172, 337.024030703454, 299.51107501462417, 269.9889485185583, 249.04669689297626, 237.1021742786833, 234.3937059677047, 240.97533317390867, 256.71573476571314, 281.30084747520056, 314.2401323034375, 354.8763620903871, 402.398734961123, 455.85905199988554, 514.1906363639546, 576.2296163502273, 640.7381477601858, 706.4291122147351, 771.9917986212188, 836.1180553784103, 897.5283915127789, 954.9975059582887, 1007.3787356020705, 1053.6269342918163, 1092.8193263072828, 1124.1739182131641, 1147.0651017274383, 1161.0361362860829, 1165.8082622434756, 1161.2862628756757, 1147.5603642096803, 1124.904434771969, 1093.770521176182, 1054.7798285796289, 1008.710325972733, 956.4812236091626, 899.1346322935902, 837.8147704735213, 773.7451340095372, 708.2040841483175, 642.4993407839261, 577.9418899352611, 515.8198260555478, 457.3726510900222, 403.766543084597, 356.07108780316264, 315.23793762022365, 282.0818235012525, 257.2642989327284, 241.2805401540983, 234.44946606246532, 236.90737492443287, 248.60522485978387, 269.3096123586475, 298.6074293081084, 335.9141056080756, 380.4852729140971, 431.43161678413793, 487.7366208891231, 548.2768492426087, 611.8443617646506, 677.1708159291948, 742.9527736024228, 807.8777081326881, 870.6501927807847, 930.0177479610478, 984.795831571459, 1033.8914737885611, 1076.325084749588]


err= 0.0
for vLoad1,vLoad2 in zip(vLoad,vLoadRef):
    err+= (vLoad2-vLoad1)**2
err= math.sqrt(err)

'''
print(fourierCoefficients)
print(err)
'''

import os
from misc_utils import log_messages as lmsg
fname= os.path.basename(__file__)
if(err<1e-5):
    print('test '+fname+': ok.')
else:
    lmsg.error(fname+' ERROR.')
    
# # Display results
# import matplotlib.pyplot as plt
# plt.plot(ti, vLoad)
# plt.show()
# plt.plot(ti, hLoad)
# plt.show()
