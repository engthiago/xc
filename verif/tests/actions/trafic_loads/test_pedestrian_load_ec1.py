# -*- coding: utf-8 -*-
''' Test values of pedestrian loads computed according to EC1.'''

from __future__ import division
from __future__ import print_function


__author__= "Luis C. PÃ©rez Tato (LCPT) and Ana Ortega (AOO)"
__copyright__= "Copyright 2015, LCPT and AOO"
__license__= "GPL"
__version__= "3.0"
__email__= "l.pereztato@gmail.com"

import math
from actions.pedestrian_trafic import EC1_pedestrian_load_models as plm

fs= 2.25 # Hz
walking= True
fourierCoefficients= plm.getFourierCoefficients(walking= walking, fs= fs, triangularModel= False)
x= list()
y= list()
for i in range(1,100):
    t= float(i)/100
    F= plm.getPedestrianVerticalLoad(t,fs= fs, fourierCoefficients= fourierCoefficients)
    x.append(t)
    y.append(F)
    
yRef= [667.3337964531555, 976.9933615492818, 1281.126165475294, 1573.6639423280146, 1848.769778122003, 2100.9545728931525, 2325.186562978831, 2516.9917182110516, 2672.543010829166, 2788.7367749575924, 2863.2546330720384, 2894.6097538549443, 2882.176518471775, 2826.2030033462743, 2727.806030369843, 2588.948883306615, 2412.4021350118, 2201.6883670654356, 1961.0118848132533, 1695.1748301882994, 1409.4813660876948, 1109.6318440834602, 801.6090671056767, 491.5589164627993, 185.66772501051835, -109.96115679632919, -389.4291391301904, -647.1600854930139, -878.0115716088969, -1077.377490593574, -1241.2799571521564, -1366.4486770696658, -1450.3861983599477, -1491.4177421373709, -1488.7246189516518, -1442.3605638402153, -1353.2506641699415, -1223.172901660738, -1054.7226768771168, -851.261024019407, -616.8475492685349, -356.1594307444322, -74.39809624634537, 222.8145591953411, 529.5483452173129, 839.6830993410668, 1147.0308006443422, 1445.4590373906806, 1729.013365106429, 1992.0361137331006, 2229.279273333432, 2436.009205978266, 2608.101094531007, 2742.1212438228436, 2835.395592089348, 2886.063065681378, 2893.112712480549, 2856.403873107971, 2776.6689874564613, 2655.4989805484, 2495.311519310592, 2299.3027736286845, 2071.3836441776198, 1816.1017294540939, 1538.5505889782157, 1244.26811310708, 939.126027255305, 629.2127352099724, 320.7118391303516, 19.778760084513046, -267.5820791255967, -535.6370583183425, -779.0377610473089, -992.9276898675868, -1173.0391664973915, -1315.7784834566528, -1418.29760817879, -1478.551008906149, -1495.3364685399347, -1468.3190720987643, -1398.0378891716464, -1285.8952180325139, -1134.1286060250934, -945.7662044865542, -724.5663489990552, -474.94257050537914, -201.8755335182044, 89.18634150785, 392.43558879094337, 701.8215717548907, 1011.1712094721967, 1314.312146200608, 1605.1959064502726, 1878.0185783072955, 2127.336617057427, 2348.175458516647, 2536.128774941203, 2687.446393095177, 2799.109120274129]

err= 0.0
for y1,y2 in zip(y,yRef):
    err+= (y2-y1)**2
err= math.sqrt(err)

'''
print(fourierCoefficients)
print(err)
'''

import os
from misc_utils import log_messages as lmsg
fname= os.path.basename(__file__)
if(err<1e-5):
    print('test '+fname+': ok.')
else:
    lmsg.error(fname+' ERROR.')
    
# # Display results
# import matplotlib.pyplot as plt
# plt.plot(x, y)
# plt.show()
